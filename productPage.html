<!DOCTYPE html>
<html>
    <head>
        <title>ThePrivilege employee stuff</title>
      
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
      
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
      
        <!--Stylesheet -->
        <link rel="stylesheet" href="./style.css">
      
        <!-- Option 1: Bootstrap Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
          crossorigin="anonymous"></script>
      
        <!-- Jquery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      
        <!-- Awesome CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
          integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        </script>
        
        <script data-main = "libs/main" src = "node_modules/requirejs/"></script>

        <!-- Gestione delle Api -->

    </head>
    <body>
        <div>
            <h1>Stai vedendo la pagina di <span id="productname"></span></h1>
            <h4><span id="productcategory"></span><span id="productsubcategory"></span></h4>
        </div>
            
        <img id="image"></img>
        
        <div id="description">
        </div>
        <div>
            <p>Le unit associate sono:</p>
            <div id="productunit">
            </div>
        </div>
            <p>I prodotti alternativi sono</p>
            <div id="altproduct">
            </div>
        <div>
        </div>
    </body>
    <footer>
        <script>
            const idProduct = localStorage.getItem("idProduct");
            const urlProduct = `https://site202120.tw.cs.unibo.it/api/products/${idProduct}`;


            async function Funzion() {
                let product = await $.get(urlProduct);
                console.log(product)

                $("#productname").append(`${product.name}`);
                $('#productcategory').append(`${product.category}`);
                $('#productsubcategory').append(`${product.subcategory}`);
                

                $('#image').attr('scr',`https://site202120.tw.cs.unibo.it${product.image}`);

                $('#description').append(`${product.description}`);

                product.altproducts.forEach(element => {
                    $.get(`https://site202120.tw.cs.unibo.it/api/products/${element}`, function(data){
                        $('#altproduct').append(`${data.name} <br>`);
                    })
                });
            }

            $(document).ready(async function() {
                await Funzion()
            })
        </script>
    </footer>
</html>